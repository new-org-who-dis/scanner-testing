api_version: 1.0

id: boostsecurityio/checkov-tf-plan
name: BoostSecurity Checkov TF Plan
namespace: boostsecurityio/checkov-tf-plan

config:
  support_diff_scan: true
  require_full_repo: true

steps:
  - scan:
      command:
        docker:
          image: bridgecrew/checkov:2.3.70@sha256:6107155c073bd969c39ea29291192459e077b2f934601683c3b33fd0fb2f9e5c
          command: --file ./boost.tfplan.json --output json --soft-fail --compact --skip-download
          workdir: /src
      format: sarif
      post-processor:
        docker:
          image: public.ecr.aws/boostsecurityio/boost-scanner-checkov:52dcef8@sha256:98aef91c93ac2400fca88beadd0ba43d1f9be15e82e6a641f8e9f4d2ea13f050
          command: process
